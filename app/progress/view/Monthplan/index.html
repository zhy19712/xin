{include file="../../public/common_header"}
<script src="__PUBLIC__/jquery/jquery.min.js"></script>
<link rel="stylesheet" href="__WEBSITE__/progress/monthplan/index.css">
<style>
    #fu{
        width:90%;
        height: 15px;
        /*border:1px solid darkcyan;*/
        margin: 20px auto;
        display: block;
        background-color: #e2e2e2;
        position: relative;
    }
    #zi{
        width:2px;
        height: 15px;
        background:lightseagreen;
    }

    #bai{
        text-align: center;
        line-height: 15px;
        color: white;
    }
    #ad i{
        margin: 0 15px;
    }
    .tipStyle{
        width: 96px;
        height: 20px;
        border: 1px solid darkseagreen;
        color: white;
        background: darkseagreen;
        text-align: center;
    }
    #leftTips,#leftTop{
        position: absolute;
        top: -25px;
        left: -48px;
        /*border: 1px solid red;*/
    }
    #rightTips{
        position: absolute;
        top: -25px;
        right: -48px;
    }


    .progress{
        position: relative;
        width:90%;
        margin:100px auto;
    }
    .progress_bg{
        height: 10px;
        border: 1px solid #ddd;
        border-radius: 5px;
        overflow: hidden;
        background-color:#f2f2f2;
    }
    .progress_bar{
        background: #5FB878;
        width: 0;
        height: 10px;
        border-radius: 5px;
    }
    .progress_btn{
        width: 20px;
        height: 20px;
        border-radius: 5px;
        position: absolute;
        background:#fff;

        left: 0px;
        margin-left: -10px;
        top:-5px;
        cursor: pointer;
        border:1px #ddd solid;
        box-sizing:border-box;
    }
    .progress_btn:hover{
        border-color:#F7B824;
    }
</style>
<div id="content">
    <div class="layui-row page-head">
        <div class="layui-col-xs2">
            <form class="layui-form" action="">
                <div class="layui-form-item">
                    <label class="layui-form-label">选择计划：</label>
                    <div class="layui-input-block">
                        <select name="city" lay-verify="required">
                            <option value="0">全部</option>
                            <option value="1">一级进度计划</option>
                            <option value="2">年度计划</option>
                            <option value="3">月度计划</option>
                        </select>
                    </div>
                </div>
            </form>
        </div>
        <div class="layui-col-xs1 layui-col-sm-offset9">
            <button class="layui-btn layui-btn-normal" id="addPlan">
                <i class="layui-icon">&#xe608;</i> 添加
            </button>
        </div>
    </div>
    <!--<div id="ad" style="margin-bottom: 40px">-->
        <!--<i id="backward" class="fa fa-fast-backward"></i>-->
        <!--<i id="start" class="fa fa-play"></i>-->
        <!--<i id="suspend" class="fa fa-pause" style="display: none"></i>-->
        <!--<i id="forward" class="fa fa-fast-forward"></i>-->
    <!--</div>-->

    <!--<div class="progress">-->
        <!--<div class="progress_bg">-->
            <!--<div class="progress_bar"></div>-->
        <!--</div>-->
        <!--<div class="progress_btn"></div>-->
        <!--<div class="text">0%</div>-->
    <!--</div>-->

    <!--<div id="fu">-->
        <!--<div id="zi">-->
            <!--<div id="bai"></div>-->
            <!--<div id="leftTips" class="tipStyle">2017-5-1</div>-->
        <!--</div>-->

        <!--<div id="leftTop" class="tipStyle">2017-5-1</div>-->
        <!--<div id="rightTips" class="tipStyle">2017-5-15</div>-->
    <!--</div>-->

    <div id="layuiRow" style="width: 100%;height: 100%">
        <table id="versonPro" class="table table-striped table-bordered" cellspacing="0"  width="100%">
            <thead>
                <th>月份</th>
                <th>计划名称</th>
                <th>所属标段</th>
                <th>编制人</th>
                <th>编制日期</th>
                <th>操作</th>
            </thead>
        </table>
        <div class="tbcontainer">
            <div class="mark"></div>
        </div>
    </div>
</div>
<!--添加新计划DOM代码-->
<form class="layui-form" action="" id="addForm" style="display: none;padding: 10px">
    <div class="layui-row">
        <div class="layui-col-sm5">
            <div class="layui-form-item">
                <label class="layui-form-label">类型</label>
                <div class="layui-input-block">

                    <select name="city" lay-verify="required">
                        <option value=""></option>
                        <option value="0">年度计划</option>
                        <option value="1">一级进度计划</option>
                        <option value="2">施工总进度计划</option>
                    </select>
                </div>
            </div>
        </div>
        <div class="layui-col-sm7">
            <div class="layui-form-item">
                <label class="layui-form-label">计划名称</label>
                <div class="layui-input-block">
                    <input type="text" name="title" required  lay-verify="required" placeholder="请输入标题" autocomplete="off" class="layui-input">
                </div>
            </div>
        </div>
        <div class="layui-col-sm5">
            <div class="layui-form-item">
                <label class="layui-form-label">编制时间</label>
                <div class="layui-input-block">
                    <input type="text" class="layui-input" id="modifiedDate">
                </div>
            </div>
        </div>
        <div class="layui-col-sm7">
            <div class="layui-form-item">
                <label class="layui-form-label">编制人</label>
                <div class="layui-input-block">
                    <input type="text" name="title" required  lay-verify="required" placeholder="请输入编制人" autocomplete="off" class="layui-input">
                </div>
            </div>
        </div>
    </div>
    <div class="layui-form-item layui-form-text">
        <label class="layui-form-label">版本描述</label>
        <div class="layui-input-block">
            <textarea name="desc" placeholder="请输入内容" class="layui-textarea"></textarea>
        </div>
    </div>
    <div class="layui-form-item">
        <div class="layui-input-block">
            <button type="button" class="layui-btn" id="test1">
                <i class="layui-icon">&#xe67c;</i>上传文件
            </button>
        </div>
    </div>
</form>
<!--删除计划DOM-->
<div class="" id="deletePlan">
    <p>确认要删除该计划吗？</p>
</div>

{include file="../../public/common_footer"}
<script type="text/javascript">

    var proWidth = $(".progress").width();
    $(function(){
        var tag = false,ox = 0,left = 0,bgleft = 0;
        $('.progress_btn').mousedown(function(e) {
            ox = e.pageX - left;
            tag = true;
        });
        $(document).mouseup(function() {
            tag = false;
        });
        $('.progress').mousemove(function(e) {
            if (tag) {
                left = e.pageX - ox;
                if (left <= 0) {
                    left = 0;
                }else if (left > proWidth) {
                    left = proWidth;
                }
                $('.progress_btn').css('left', left);
                $('.progress_bar').width(left);
                $('.text').html(parseInt((left/proWidth)*100) + '%');
            }
        });

        $('.progress_bg').click(function(e) {
            if(!tag) {
                bgleft = $('.progress_bg').offset().left;
                left = e.pageX - bgleft;

                if (left <= 0) {
                    left = 0;
                }

                if(left > proWidth) {
                    left = proWidth;
                }

                $('.progress_btn').css('left', left);
                $('.progress_bar').animate({width:left},proWidth);
                $('.text').html(parseInt((left/proWidth)*100) + '%');
            }
        });
    });

    var stime, stimeBackward, stimeForward, times = 1200, backTime = 1200;

    //清除叠加
    function cleanSupTime() {
        window.clearInterval(stime);
        window.clearInterval(stimeBackward);
        window.clearInterval(stimeForward);
    }

    //暂停样式
    function cleanSupElement() {
        cleanSupTime();
        $("#start").css("display","inline-block").siblings("#suspend").css("display","none");
    }

    //开始
    $("#start").click(function () {
        //开始
        $("#start").css("display","none").siblings("#suspend").css("display","inline-block");
         cleanSupTime();
        stime = setInterval(function (){
            $("#fu").css("display","block");
            var oleft = $("#zi")[0].offsetWidth + 96;
            var tipsLeft = Math.round($("#leftTips").offset().left+10);
            var ob = oleft/$("#fu")[0].offsetWidth;
            $("#zi").css("width",oleft+"px");
            $("#leftTips").css("left",tipsLeft+"px");
            if($("#zi")[0].offsetWidth -12 == $("#fu")[0].offsetWidth){
                cleanSupElement();
            }
        },1200)
        if($("#zi")[0].offsetWidth-12 == $("#fu")[0].offsetWidth){
            cleanSupElement();
        }
    });

    //暂停
    $("#suspend").click(function () {
        $("#start").css("display","inline-block").siblings("#suspend").css("display","none");
        cleanSupTime();
    });

    //快退
    $("#backward").click(function () {
        console.log($("#start").css("display"))
        if($("#start").css("display") == 'none'){
            cleanSupTime();
            backTime /= 1.5;
            if(parseInt(backTime) == 237){
                backTime =237
                alert("亲，不能再退这么快了！")
            }
            stime = setInterval(function (){
                $("#fu").css("display","block");
                var oleft = $("#zi")[0].offsetWidth - 96;
                var tipsLeft = Math.round($("#leftTips").offset().left);
                console.log(tipsLeft + "left ")
                var ob = oleft/$("#fu")[0].offsetWidth;
                $("#zi").css("width",oleft+"px");
                tipsLeft -= 181;
                $("#leftTips").css("left",tipsLeft+"px");
                if(oleft == 2){
                    cleanSupElement()
                }
            },backTime)
        }
    });

    //快进
    $("#forward").click(function () {
        console.log($("#start").css("display"))
        if($("#start").css("display") == 'none'){
            cleanSupTime();
            times /= 1.5;
            if(parseInt(times) == 237){
                times =237
                layer.msg("亲，不能再快了！")
            }
            stime = setInterval(function (){
                $("#fu").css("display","block");
                var oleft = $("#zi")[0].offsetWidth + 96;
                var tipsLeft = Math.round($("#leftTips").offset().left+10);
                var ob = oleft/$("#fu")[0].offsetWidth;
                $("#zi").css("width",oleft+"px");
                $("#leftTips").css("left",tipsLeft+"px");
                if($("#zi")[0].offsetWidth -12 == $("#fu")[0].offsetWidth){
                    cleanSupElement();
                }
            },times)

        }

    });

    // 初始化
    var versonPro = $('#versonPro').dataTable( {
        pagingType: "full_numbers",
        processing: true,
        retrieve: true,
        serverSide: true,
        ajax: {
            "url": "{:url('/progress/monthplan/datatablesPre')}?tableName=progress_monthplan"
        },
        "scrollY": "200px",
        "scrollCollapse": "true",
        dom: 'lrtip',
        columns: [
            {
                "name": "month"
            },
            {
                "name": "planname"
            },
            {
                "name": "position"
            },
            {
                "name": 'maker'
            },
            {
                "name": "createdate"
            },
            {
                "name": "id"
            }

        ],
        columnDefs: [
            {
                "targets": [5],
                "searchable": false,
                "orderable": false,
                "render": function (data, type, row) {
                    var html = "<a class='styleColor' type='button' style='margin-left: 5px;' href='../Yearplan/index'><i title='查看' class='fa fa fa-search'></i></a>";
                    html += "<a class='styleColor' type='button' href='../Yearplan/index' style='margin-left: 5px;'><i title='编辑' class='fa fa fa-pencil'></i></a>";
                    html += "<a class='styleColor' type='button' href='javascript:;' style='margin-left: 5px;'><i title='删除' class='fa fa fa-remove'></i></a>";
                    html += "<a class='styleColor' href='javascript:;' style='margin-left: 7px;' onclick='viewFile("+row[5]+")'><i title='关联视图' class='fa fa-chain'></i></a>";
                    html += "<a class='styleColor' href='javascript:;' style='margin-left: 7px;' onclick='monthFile("+row[5]+")'><i title='月度计划' class='fa fa-list-ol'></i></a>";
                    return html;
                }
            }
        ],
        language: {
            "lengthMenu": "_MENU_",
            "zeroRecords": "没有找到记录",
            "info": "第 _PAGE_ 页 ( 总共 _PAGES_ 页 )",
            "infoEmpty": "无记录",
            "search": "搜索：",
            "infoFiltered": "(从 _MAX_ 条记录过滤)",
            "paginate": {
                "sFirst": "<<",
                "sPrevious": "<",
                "sNext": ">",
                "sLast": ">>"
            }
        },
        "fnInitComplete": function (oSettings, json) {
            $('#versonPro_length').insertBefore(".mark");
            $('#versonPro_info').insertBefore(".mark");
            $('#versonPro_paginate').insertBefore(".mark");
        }
    } );

    //关联视图
    function viewFile(id) {
        document.cookie="monthId="+id;
        window.open('./assview.shtml');
        console.log(id)
    }
    //关联视图
    function monthFile(id) {
        document.cookie="proId="+id;
        window.open('./progress.shtml');
        console.log(id)
    }

    //添加计划
    layui.use('layer', function(){
        var layer = layui.layer;
        $("#addPlan").click(function () {
            addNewPlan();
        });
        $(".versonBody .layui-btn-danger").click(function () {
            deletePlan();
        });
    });

    //编制时间
    layui.use('laydate', function(){
        var laydate = layui.laydate;

        //执行一个laydate实例
        laydate.render({
            elem: '#modifiedDate' //指定元素
        });
    });

    //添加新计划
    function addNewPlan() {
        layer.open({
            title:['添加新计划','font-size:18px'],
            type: 1,
            content: $("#addForm") ,
            area:['680px','420px'],
            btn: ['确认', '取消'],
            yes: function(index, layero){
                alert('添加成功')
            },
            btn2: function(index, layero){

            },
            cancel: function(){

            }
        });
    }

    //删除计划
    function deletePlan() {
        layer.open({
            title:['删除计划','font-size:18px'],
            type: 1,
            content: $("#deletePlan") ,
            area:['680px','320px'],
            btn: ['确认', '取消'],
            yes: function(index, layero){
                alert('删除成功');
            },
            btn2: function(index, layero){
            },
            cancel: function(){
            }
        });
    }


</script>


    <!--<style type="text/css">-->
        <!--/*进度条*/-->
        <!--#jdL {-->
            <!--display: none;-->
        <!--}-->
        <!--.irs-from, .irs-to, .irs-single {-->
            <!--font-size: 14px;-->
        <!--}-->
        <!--.irs-min, .irs-max {-->
            <!--font-size: 14px;-->
        <!--}-->
        <!--/*进度条*/-->
    <!--</style>-->
<!--</head>-->

<!--<body>-->

<!--<div class="col-md-12">-->

    <!--<div class="portlet light bordered" style="padding-top: 0px;">-->
        <!--<div class="portlet-title" id="jdF" style="display: none;">-->
            <!--<div class="caption font-green-haze" style="margin-top: 10px; margin-left: -10px;">-->
                <!--<i class="icon-settings font-green-haze"></i>-->
                <!--<span class="caption-subject bold uppercase" id="spanPlanName">一期地下厂房</span>-->
                <!--<input id="hidScheduleVersionID" type="hidden" value="d3c1d9e6-095d-4165-a52e-223d3c58c62b">&lt;!&ndash;月计划标识&ndash;&gt;-->
                <!--<input id="hidTask_ID" type="hidden" value="3">&lt;!&ndash;任务的标识&ndash;&gt;-->
                <!--<input id="hidScheduleVersionStatus" type="hidden">-->
                <!--<input id="hidSectionId" type="hidden" value="93b8f274-fc9e-4105-9ab1-21adeedc890f">&lt;!&ndash;标段标识&ndash;&gt;-->
                <!--<input id="hidMenuId" type="hidden" value="20ed3d93-4801-41ca-816c-6db6bc65486c">-->
                <!--<input id="hidTaskIndeny" type="hidden" value="0">-->
                <!--<input id="hidElementStr" type="hidden" value="10000114,10000115,10000116,10000117,10000119,10000118,10000120,10000121,10000122,10000123,10000124,10000125,10000126,10000127,10000128,10000354,10000355,10000357,10000358,10000356,10000360,10000359,10000183,10000185,10000193,10000194,10000347,10000348,10000181,10000182,10000183,10000184,10000185,10000186,10000187,10000188,10000189,10000190,10000191">-->
                <!--<input id="hidElmentIds" type="hidden" value="10000114,10000115,10000116,10000117,10000118,10000119,10000120,10000121,10000122,10000123,10000124,10000125,10000126,10000127,10000128,10000181,10000182,10000183,10000184,10000185,10000186,10000187,10000188,10000189,10000190,10000191,10000193,10000194,10000347,10000348,10000354,10000355,10000356,10000357,10000358,10000359,10000360">-->
                <!--<input id="hidMonthStartDate" type="hidden" value="2017/11/01">-->
                <!--<input id="hidMonthEndDate" type="hidden" value="2017/11/30">-->
                <!--<input id="hidProjectName" type="hidden" value="丰宁抽水蓄能电站">-->
            <!--</div>-->

            <!--<div id="selectBiao" style="margin-top: 2px; margin-bottom: 10px; float: right;">-->
                <!--<button title="返回月计划列表" class="btn btn-danger " style="font-size: 14px; margin-top: 5px; float: right;" onclick="gBack()" type="button">-->
                    <!--&lt;!&ndash;<span class="bold">保存视频</span>&ndash;&gt;返回-->
                <!--</button>-->
                <!--<p1 style="margin: 8px 0px 0px; line-height: 30px; font-size: 14px; float: right;">-->
                    <!--所属标段:&nbsp;&nbsp;&nbsp;&nbsp;-->
                    <!--<input class="form-control" style="width: 200px; margin-top: -3px; margin-right: 5px; margin-left: 5px; float: right;" type="text" readonly="" value="一期地下厂房">-->

                <!--</p1>-->
            <!--</div>-->
        <!--</div>-->

        <!--<div class="portlet-title" id="jdL" style="padding-right: 20px; padding-left: 20px; display: block;">-->
            <!--<span class="irs js-irs-2"><span class="irs"><span tabindex="-1" class="irs-line"><span class="irs-line-left"></span><span class="irs-line-mid"></span><span class="irs-line-right"></span></span><span class="irs-min" style="visibility: hidden;">2017-11-01</span><span class="irs-max" style="visibility: visible;">2017-11-30</span><span class="irs-from" style="left: -2.2%; visibility: visible;">2017-11-01</span><span class="irs-to" style="left: 32.09%; visibility: visible;">2017-11-11</span><span class="irs-single" style="left: 12.05%; visibility: hidden;">2017-11-01 — 2017-11-11</span></span><span class="irs-grid"></span><span class="irs-bar" style="left: 0.34%; width: 34.3%;"></span><span class="irs-shadow shadow-from" style="display: none;"></span><span class="irs-shadow shadow-to" style="display: none;"></span><span class="irs-slider from" style="left: 0%;"></span><span class="irs-slider to type_last" style="left: 34.3%;"></span></span><div class="irs-hidden-input" id="range_39"></div>-->
        <!--</div>-->
        <!--<div class="portlet-body form">-->
            <!--<div class="row" id="yuanli1" style="height: 55px; display: block;">-->
                <!--<div class="col-md-12">-->
                    <!--<div style="margin-top: 8px; margin-right: 15px; float: right;">-->
                        <!--<a title="减速" class="speed" id="speed" style="margin-top: 9px;" onclick="minusSpeed()"></a>-->
                        <!--<a title="播放" class="spplay" id="spplay" style="margin-top: 9px;" onclick=""></a>-->
                        <!--<a title="停止" class="spstops" id="spstop" style="margin-top: 9px;" onclick=""></a>-->
                        <!--<a title="快进" class="rewind" id="rewind" style="margin-top: 9px;" onclick="addSpeed();"></a>-->
                        <!--<a title="返回" class="spup" id="spup" style="margin-top: 9px;" onclick="cback()"></a>-->
                    <!--</div>-->
                    <!--<p id="beiSu" style="color: rgb(32, 180, 38); margin-top: 14px; float: right; display: block;">倍速：(<span id="binfo">1</span>x)</p>-->

                    <!--<table class="fangan1" id="cangmian" style="margin-top: 5px; margin-left: 5px; display: none;" clclass="full-width">-->
                        <!--<tbody><tr>-->
                            <!--<td style="width: 150px;">-->
                                <!--<div class="form-group div-inline data_2" style="margin-right: -2px; margin-left: 2px;">-->

                                    <!--<div class="input-group date" style="width: 150px;">-->
                                        <!--<span class="input-group-addon"><i class="fa fa-calendar"></i></span>-->
                                        <!--<input class="form-control" id="txtStartDate" onchange="changeDate()" type="text" value="2016-06-04">-->
                                    <!--</div>-->

                                <!--</div>-->
                            <!--</td>-->
                            <!--<td style="width: 30px; text-align: center;">-->
                                <!--<label style="margin-top: 3px;">至</label>-->
                            <!--</td>-->
                            <!--<td style="width: 150px;">-->
                                <!--<div class="form-group div-inline data_2" style="margin-right: -2px; margin-left: 2px;">-->

                                    <!--<div class="input-group date" style="width: 150px;">-->
                                        <!--<span class="input-group-addon"><i class="fa fa-calendar"></i></span>-->
                                        <!--<input class="form-control" id="txtEndDate" onchange="changeDate()" type="text" value="2016-06-04">-->
                                    <!--</div>-->
                                <!--</div>-->
                            <!--</td>-->
                        <!--</tr>-->
                        <!--</tbody></table>-->
                    <!--<div id="fangan2" style="margin-top: 5px; margin-left: 15px; float: left; display: none;">-->
                        <!--<span id="startDate"></span>-<span id="endDate"></span>-->
                    <!--</div>-->
                    <!--<div style="margin-top: 5px; margin-left: 5px; float: left; display: none;">-->
                        <!--<button class=" btn btn-warning screenRecord" style="margin-left: 5px; display: none;" onclick="recordStar()" type="button">-->
                            <!--视频录制-->
                        <!--</button>-->
                        <!--<button class="btn btn-warning screenRecording" id="srStart" style="margin-left: 5px;" type="button">-->
                            <!--暂停-->
                        <!--</button>-->
                        <!--<button class="btn btn-primary screenRecording" style="margin-left: 5px;" onclick="recordEnd()" type="button">-->
                            <!--保存-->
                        <!--</button>-->
                        <!--<button class="btn btn-danger screenRecording" style="margin-left: 5px;" onclick="recordEnd()" type="button">-->
                            <!--丢弃-->
                        <!--</button>-->
                    <!--</div>-->
                    <!--<script>-->
                        <!--function banben() {-->
                            <!--var index = top.layer.open({-->
                                <!--type: 2,-->
                                <!--title: '<a data-toggle="collapse" data-parent="#accordion" href="#collapseTwo"><i class="fa fa-adjust" style="margin-right: 10px;"></i>版本对比</a>',-->
                                <!--content: '/ModelFile/Contrast/',-->
                            <!--});-->
                            <!--top.layer.full(index);-->
                        <!--}-->
                        <!--//引入总进度计划数据-->
                        <!--function yinru() {-->
                            <!--$.ajax({-->
                                <!--url: "/Schedule/ScheduleMonthTask/IntroduceMonthTask",-->
                                <!--type: "Post",-->
                                <!--data: { "sectionId": $("#hidSectionId").val(), "scheduleMonthID": $("#hidScheduleVersionID").val() },-->
                                <!--success: function (data) {-->
                                    <!--if (data.result == "Success") {-->
                                        <!--alert("引入成功");-->
                                        <!--InitData();-->
                                    <!--}-->
                                    <!--else if (data.result == "Failds") {-->
                                        <!--alert("已经引入过数据");-->
                                    <!--}-->
                                    <!--else {-->
                                        <!--alert("获取月计划信息失败");-->
                                    <!--}-->
                                <!--},-->
                                <!--error: function () {-->
                                    <!--alert("Error");-->
                                <!--}-->
                            <!--})-->
                        <!--}-->
                        <!--///IntroduceLastJanuaryNoFinishTask-->
                        <!--function IntroduceNoFinishTask() {-->
                            <!--$.ajax({-->
                                <!--url: "/Schedule/ScheduleMonthTask/IntroduceLastJanuaryNoFinishTask",-->
                                <!--type: "Post",-->
                                <!--data: { "sectionId": $("#hidSectionId").val(), "scheduleMonthID": $("#hidScheduleVersionID").val() },-->
                                <!--success: function (data) {-->
                                    <!--if (data.result == "Success") {-->
                                        <!--alert("引入成功");-->
                                        <!--InitData();-->
                                    <!--}-->
                                    <!--else {-->
                                        <!--alert("已经引入过数据");-->
                                    <!--}-->
                                <!--},-->
                                <!--error: function () {-->
                                    <!--alert("Error");-->
                                <!--}-->
                            <!--})-->
                        <!--}-->
                        <!--function recordStar() {-->
                            <!--$(".screenRecord").hide();-->
                            <!--$(".screenRecording").show();-->
                        <!--}-->
                        <!--function recordEnd() {-->
                            <!--$(".screenRecording").hide();-->
                            <!--$(".screenRecord").show();-->
                        <!--}-->
                        <!--$("#srStart").click(function () {-->
                            <!--var content = $("#srStart").text(); //获取title内容-->
                            <!--if (content == "继续") {-->
                                <!--$("#srStart").text("暂停")-->
                            <!--} else {-->
                                <!--$("#srStart").text("继续")-->
                            <!--}-->
                        <!--});-->
                        <!--function gBack() {-->
                            <!--window.location.href = "/schedule/ScheduleMonth/index?id=20ed3d93-4801-41ca-816c-6db6bc65486c";-->
                        <!--}-->
                    <!--</script>-->
                <!--</div>-->
            <!--</div>-->

        <!--</div>-->
    <!--</div>-->



<!--</div>-->

<!--<script>-->
    <!--var elementIds = [];-->
    <!--$(function () {-->
        <!--$('div.gantt_task').resize(function () {-->
            <!--if (mSize == 1) {-->
                <!--modelSize();-->
            <!--} else {-->
                <!--jdSize();-->
            <!--}-->
        <!--});-->
        <!--if ($("#hidElmentIds").val()) {-->
            <!--elementIds = $("#hidElmentIds").val().split(',');-->
        <!--}-->
        <!--Array.prototype.contains = function (needle) {-->
            <!--for (i in this) {-->
                <!--if (this[i] == needle) return true;-->
            <!--}-->
            <!--return false;-->
        <!--}-->

        <!--$("#spplay").click(function () {-->
            <!--$("#fangan1").hide();-->
            <!--$("#fangan2").hide();-->
            <!--$(this).removeClass();-->
            <!--var adom = $('#spplay'); //根据标签的id获取标签a的dom节点，jquery方式-->
            <!--var title = adom.attr('title'); //获取title内容-->
            <!--IsVideo = true;-->
            <!--if (title == "播放") {-->
                <!--if (PlayArray != undefined && PlayArray.length > 0) {-->
                    <!--if ($("#selDate").val() == "0")-->
                        <!--interval = setInterval(playPlan, playSpeed);-->
                    <!--else-->
                        <!--play();-->
                <!--}-->
                <!--else {-->

                    <!--play();-->

                <!--}-->
                <!--rMeSize = 0;-->
                <!--jdSize();-->
                <!--$("#fright").show();-->
                <!--$("#spplay").attr("title", "暂停");-->
                <!--$("#spplay").attr("class", "spplays");-->
                <!--$("#spstop").attr("class", "spstops");-->
                <!--$("#rewind").attr("class", "rewind");-->
                <!--$("#speed").attr("class", "speed");-->
            <!--} else {-->
                <!--suspend();-->
                <!--$("#spplay").attr("title", "播放");-->
                <!--$("#spplay").attr("class", "spplay");-->
                <!--$("#spstop").attr("class", "spstops");-->
            <!--}-->
            <!--$("#beiSu").show();-->
        <!--});-->
        <!--$("#spstop").click(function () {-->
            <!--//$("#fangan1").show();-->
            <!--//$("#fangan2").show();-->
            <!--$(this).removeClass();-->
            <!--$(this).addClass('spstop'); // 添加当前元素的样式-->
            <!--$("#spplay").attr("class", "spplay");-->
            <!--$("#spplay").attr("title", "播放");-->
            <!--Stop();-->
            <!--rMeSize = 1;-->
            <!--jdSize();-->
            <!--$("#fright").hide();-->
            <!--$("#beiSu").hide();-->
            <!--$("#rewind").attr("class", "rewinds");-->
            <!--$("#speed").attr("class", "speeds");-->
        <!--});-->
    <!--});-->
<!--</script>-->
<!--<script>-->


    <!--var selModel = 0;-->
    <!--var isMulti = false;-->
    <!--var multiSelModel = [];-->

    <!--function modelShow() {-->
        <!--gantsShow = 1;-->
        <!--if (mSize == 1) {-->
            <!--modelSize();-->
        <!--} else {-->
            <!--jdSize();-->
        <!--}-->
        <!--$("#RealBimOcx").show();-->

        <!--$(".gantt_hor_scroll").css("overflow-x", "hidden");-->

    <!--}-->


    <!--function programManage() {-->
        <!--var svid = $("#hidScheduleVersionID").val();-->
        <!--if (svid) {-->
            <!--window.open('/Schedule/Plan/PlanSolution?svid=' + svid, '模拟方案管理', 'height=480, width=780, top=200,left=400, toolbar=no, menubar=no, scrollbars=no, resizable=no,location=no,status=no');-->
        <!--}-->
    <!--}-->
    <!--//根据设计视图与模型关联数据，及授权数据控制设计视图树及三维模型的状态。-->
    <!--function initTreeAndModelState() {-->
        <!--isAllLoadComplete = true;-->
        <!--$.ajax({-->
            <!--type: "Get",-->
            <!--url: "/Design/GetRelationAndPermissionData?_t=" + new Date().getTime(),-->
            <!--success: function (data) {-->
                <!--data = data.result;-->
                <!--if (data.elementIds.length === 0 && (data.invisibleElementIds === null || data.invisibleElementIds.length === 0)) {-->
                    <!--//top.layer.closeAll();-->
                    <!--RealBimOcx.SetSceHugeObjVisible(true);-->
                    <!--return;-->
                <!--};-->

                <!--RealBimOcx.SetAllHugeObjSubValidState(0);-->
                <!--RealBimOcx.SetHugeObjSubValidStateBegin();-->
                <!--$.each(data.elementIds, function (i, item) {-->
                    <!--RealBimOcx.SetHugeObjSubValidStateInfo(item, 1);-->
                <!--});-->
                <!--RealBimOcx.SetHugeObjSubValidStateEnd();-->
                <!--RealBimOcx.SetSceHugeObjVisible(true);-->
            <!--}-->
        <!--});-->
        <!--RealBimOcx.SetAllSubClrInfos(0, 255, 0);-->
        <!--if ($("#hidElementStr").val() != null && $("#hidElementStr").val() != "") {-->
            <!--if (mSize == 1)-->
                <!--RealBimOcx.SetSubArrayClrInfo($("#hidElementStr").val(), 255, 255, 0);-->
            <!--else-->
                <!--RealBimOcx.SetSubArrayClrInfo($("#hidElementStr").val(), 60, 255, 0xff447fed);-->
        <!--}-->
        <!--RealBimOcx.SetSubArrayClrInfo($("#hidElmentIds").val(), 255, 255, 0);-->
        <!--SetSpecialColor();-->
    <!--};-->
    <!--//设置特殊构件显示-->
    <!--function SetSpecialColor() {-->
        <!--var projectId = $(top.document).find("#projectId").val();-->
        <!--if (projectId === "res_fengning_kw_03") {-->
            <!--RealBimOcx.SetSubArrayClrInfo("10000577,10000578", 10, 255, 0x80808000);-->
        <!--}-->
    <!--}-->
    <!--//标记是否是第一次显示模型：0是，1否-->
    <!--//点击模拟进度由0变1；返回1变0-->
    <!--var modelIsAlpha = 0;-->

    <!--//播放过程中用到的变量及默认值-->
    <!--var playSpeed = 1000;//时间控制 单位毫秒-->
    <!--var playBeiSu = 1;//播放倍速-->
    <!--var PlayArray = [];//模拟日期数组-->
    <!--var taskArray = [];//模拟任务数组-->
    <!--var MonthTaskArray = [];//模拟构件数组-->
    <!--var currentIndex = 0;-->
    <!--var interval;-->
    <!--function SetDefault() {-->
        <!--//初始化变量的值-->
        <!--playSpeed = 1000;-->
        <!--$("#binfo").html(playBeiSu);-->
        <!--RealBimOcx.SetAllSubClrInfos(0, 255, 0);-->
        <!--if ($("#hidElementStr").val() != null && $("#hidElementStr").val() != "") {-->
            <!--RealBimOcx.SetSubArrayClrInfo($("#hidElementStr").val(), 60, 255, 0xff447fed);-->
        <!--}-->
        <!--RealBimOcx.SetSubArrayClrInfo($("#hidElmentIds").val(), 255, 255, 0);-->
        <!--SetSpecialColor();-->
    <!--}-->

    <!--function jindu() {-->
        <!--mSize = 0;-->
        <!--modelShow();-->
        <!--modelIsAlpha = 1;-->
        <!--$("#editTable").hide();-->
        <!--$("#yuanli1").show();-->
        <!--SetDefault();-->
        <!--$("#jdF").hide();-->
        <!--$("#jdL").show();-->

    <!--}-->
    <!--//加速播放-->
    <!--function addSpeed() {-->
        <!--if (playBeiSu >= 16) {-->
            <!--return;-->
        <!--}-->
        <!--clearInterval(interval);-->
        <!--playSpeed /= 2;-->
        <!--playBeiSu *= 2;-->
        <!--$("#binfo").html(playBeiSu);-->
        <!--interval = setInterval(playPlan, playSpeed);-->
    <!--}-->
    <!--//减速-->
    <!--function minusSpeed() {-->
        <!--if (playBeiSu <= 1) {-->
            <!--return;-->
        <!--}-->
        <!--clearInterval(interval);-->
        <!--if (playSpeed < 1000) {-->
            <!--playSpeed *= 2;-->
            <!--alert(playSpeed);-->
            <!--playBeiSu /= 2;-->
        <!--}-->
        <!--$("#binfo").html(playBeiSu);-->
        <!--interval = setInterval(playPlan, playSpeed);-->
    <!--}-->
    <!--//进度模拟播放-->
    <!--function play() {-->
        <!--top.layer.msg("正在加载进度模拟数据...", {-->
            <!--offset: 0,-->
            <!--time: 0-->
        <!--});-->
        <!--top.layer.load(1);-->
        <!--$.ajax({-->
            <!--type: "Get",-->
            <!--url: "/Schedule/Version/GetMonthPlayData?id=" + $("#hidScheduleVersionID").val() + "&_t=" + new Date(),-->
            <!--success: function (data) {-->
                <!--if ($("#selDate").val() == "0") {-->
                    <!--PlayArray = data.result[0];-->
                <!--}-->
                <!--top.layer.closeAll();-->
                <!--taskArray = data.result[1];-->
                <!--MonthTaskArray = data.result[2];-->
                <!--interval = setInterval(playPlan, playSpeed);-->
            <!--}, error: function (data) {-->
                <!--top.layer.closeAll();-->
            <!--}-->
        <!--});-->
    <!--};-->
    <!--//停止-->
    <!--function Stop() {-->
        <!--clearInterval(interval);-->
        <!--currentIndex = 0;-->
        <!--playBeiSu = 1;-->
        <!--playSpeed = 1000;-->
        <!--resetSlider();-->
        <!--SetDefault();-->
    <!--}-->
    <!--//暂停-->
    <!--function suspend() {-->
        <!--clearInterval(interval);-->
    <!--}-->
    <!--function playPlan() {-->
        <!--if (currentIndex === 0) {-->
            <!--SetDefault();-->
        <!--}-->
        <!--if (currentIndex >= PlayArray.length)-->
            <!--clearInterval(interval);-->
        <!--var date = PlayArray[currentIndex];-->
        <!--var preIds = "";//[];-->
        <!--var ids = ""; //[];-->
        <!--var indexs = [];-->
        <!--var fxIds = "";-->
        <!--if (date == null || date == "") {-->
            <!--return;-->
        <!--}-->
        <!--if (date.length > 0) {-->
            <!--var dates = date.substring(0, 4) + "年" + date.substring(4, 6) + "月";-->
            <!--var dateInfo = date.substring(0, 4) + "-" + date.substring(4, 6) + "-" + date.substring(6, 8);-->
            <!--$("#datestr").html(dates);-->
            <!--$("#day").html(date.substring(6, 8));-->
            <!--var days = new Date(dateInfo).getDay();-->
            <!--switch (days) {-->
                <!--case 0:-->
                    <!--$("#weekinfo").html("星期日");-->
                    <!--break;-->
                <!--case 1:-->
                    <!--$("#weekinfo").html("星期一");-->
                    <!--break;-->
                <!--case 2:-->
                    <!--$("#weekinfo").html("星期二");-->
                    <!--break;-->
                <!--case 3:-->
                    <!--$("#weekinfo").html("星期三");-->
                    <!--break;-->
                <!--case 4:-->
                    <!--$("#weekinfo").html("星期四");-->
                    <!--break;-->
                <!--case 5:-->
                    <!--$("#weekinfo").html("星期五");-->
                    <!--break;-->
                <!--case 6:-->
                    <!--$("#weekinfo").html("星期六");-->
                    <!--break;-->
            <!--}-->

            <!--var pdate = date.substring(0, 4) + "/" + date.substring(4, 6) + "/" + date.substring(6, 8);-->
            <!--var sdate = PlayArray[0].substring(0, 4) + "/" + PlayArray[0].substring(4, 6) + "/" + PlayArray[0].substring(6, 8);-->
            <!--var edate = PlayArray[PlayArray.length - 1];-->
            <!--edate = edate.substring(0, 4) + "/" + edate.substring(4, 6) + "/" + edate.substring(6, 8);-->
            <!--//alert($("#range_39").html());-->
            <!--if (currentIndex <= 0) {-->
                <!--var slider = $("#range_39").data("ionRangeSlider");-->
                <!--slider.destroy();-->
                <!--$("#range_39").ionRangeSlider({-->
                    <!--type: "double",-->
                    <!--//            grid: true,-->
                    <!--min: timez('' + sdate + ''),-->
                    <!--max: timez('' + edate + ''),-->

                    <!--from: timez('' + sdate + ''),-->
                    <!--from_min: timez('' + sdate + ''),-->
                    <!--from_max: timez('' + edate + ''),-->
                    <!--//from_shadow: true,-->
                    <!--to: timez('' + edate + ''),-->
                    <!--to_min: timez('' + sdate + ''),-->
                    <!--to_max: timez('' + edate + ''),-->
                    <!--onChange: function (data) {-->
                        <!--clearInterval(interval);-->
                        <!--//alert(data.to);-->
                    <!--},-->
                    <!--onFinish: function (data) {-->
                        <!--var nowDate = normalTime(data.to);-->
                        <!--skipTask(nowDate);-->
                    <!--},-->
                    <!--//to_shadow: true,-->
                    <!--prettify: function (num) {-->
                        <!--var newTime = new Date(num);-->
                        <!--return (newTime).toISOString().slice(0, 10);-->
                    <!--}-->
                <!--});-->
            <!--}-->
            <!--else {-->
                <!--var slider = $("#range_39").data("ionRangeSlider");-->
                <!--// 使用`update`指令更新参数-->
                <!--slider.update({-->
                    <!--type: "double",-->
                    <!--//            grid: true,-->
                    <!--min: timez('' + sdate + ''),-->
                    <!--max: timez('' + edate + ''),-->
                    <!--//from: timez('' + pdate + ''),-->
                    <!--//from_shadow: true,-->
                    <!--to: timez('' + pdate + ''),-->
                    <!--//to_shadow: true,-->
                    <!--prettify: function (num) {-->
                        <!--var newTime = new Date(num);-->
                        <!--return (newTime).toISOString().slice(0, 10);-->
                    <!--}-->
                    <!--// etc.-->
                <!--});-->
                <!--// 使用reset()重置-->
                <!--slider.reset();-->
            <!--}-->

        <!--}-->
        <!--//循环任务数组查找日期下所有任务-->
        <!--for (var n = 0; n < taskArray.length; n++) {-->
            <!--if (taskArray[n].sdate >= date || date <= taskArray[n].edate) {-->
                <!--indexs.push(n);-->
            <!--}-->
        <!--}-->
        <!--var monthTask = MonthTaskArray[currentIndex];-->
        <!--if (monthTask != null)-->
        <!--{-->
            <!--//计划开始的构件-->
            <!--if (monthTask.planStartElement) {-->
                <!--RealBimOcx.SetSubArrayClrInfo(monthTask.planStartElement, 60, 255, 0xff00ff00);-->
            <!--}-->
            <!--//计划结束的构件-->
            <!--if (monthTask.planFinishElement) {-->
                <!--RealBimOcx.SetSubArrayClrInfo(monthTask.planFinishElement, 255, 255, 0);-->
            <!--}-->
            <!--//计划完成的逆向构件-->
            <!--if (monthTask.actualSpecialElement) {-->
                <!--RealBimOcx.SetSubArrayClrInfo(monthTask.actualSpecialElement, 60, 255, 0xff447fed);-->
            <!--}-->

        <!--}-->
        <!--var html = "";-->
        <!--$.each(indexs, function (t, item) {-->
            <!--var n = parseInt(item);-->
            <!--var str = "";-->
            <!--var task = taskArray[n];-->
            <!--if (task != null) {-->
                <!--if (task.eleids) {-->
                    <!--str = "<a ><i class='fa gantt_button_grid fa-cube'></i>" + taskArray[n].taskWbs + "</a>";-->
                <!--}-->
                <!--else {-->
                    <!--str = "<a >" + taskArray[n].taskWbs + "</a>";-->
                <!--}-->
            <!--}-->
            <!--html += "<tr onclick='getFirstElementFoucs(" + n + ")'><td>" + str + "</td><td>" + taskArray[n].sdate.substring(0, 4) + "-" + taskArray[n].sdate.substring(4, 6) + "-" + taskArray[n].sdate.substring(6, 8) + "</td><td>" + taskArray[n].edate.substring(0, 4) + "-" + taskArray[n].edate.substring(4, 6) + "-" + taskArray[n].edate.substring(6, 8) + "</td></tr>";-->
        <!--})-->
        <!--$("#tasklist").html(html);-->

        <!--//if (ids.length > 0) {-->
        <!--//    var newIds = "";-->
        <!--//    var idArray = ids.split(',');-->
        <!--//    for (var i = 0; i < idArray.length; i++) {-->
        <!--//        if (elementIds.contains(idArray[i])) {-->
        <!--//            if (fxIds != "") {-->
        <!--//                fxIds += ',' + idArray[i];-->
        <!--//            }-->
        <!--//            else-->
        <!--//                fxIds = idArray[i];-->
        <!--//        }-->
        <!--//        else {-->
        <!--//            if (newIds != "") {-->
        <!--//                newIds += ',' + idArray[i];-->
        <!--//            }-->
        <!--//            else-->
        <!--//                newIds = idArray[i];-->
        <!--//        }-->
        <!--//    }-->
        <!--//    ids = newIds;-->
        <!--//    RealBimOcx.SetSubArrayClrInfo(ids, 255, 255, 0);-->
        <!--//    RealBimOcx.SetSubArrayClrInfo(fxIds, 60, 255, 0xff447fed);-->
        <!--//}-->
        <!--currentIndex++-->
    <!--}-->
    <!--//选中任务的第一个构件-->
    <!--function getFirstElementFoucs(index) {-->
        <!--var task = taskArray[index];-->
        <!--if (task != null) {-->
            <!--if (task.eleids) {-->
                <!--clearInterval(interval);-->
                <!--RealBimOcx.SetSubArrayClrInfo(task.eleids, 128, 255, 0xffdaa520);-->
                <!--var tmpIds = task.eleids.split(',');-->
                <!--if (tmpIds.length > 0) {-->
                    <!--RealBimOcx.FocusCameraToComponent(parseInt(tmpIds[0]), 2);-->
                <!--}-->
                <!--setTimeout(function () { SetElementOriginalColor(index); }, 3000);-->
            <!--}-->
        <!--}-->
    <!--}-->
    <!--//恢复任务模拟中原本构件颜色-->
    <!--function SetElementOriginalColor(cindex) {-->
        <!--//interval = setInterval(playPlan, playSpeed);-->
        <!--if ($("#spplay").attr("class") != "spplay") {-->
            <!--interval = setInterval(playPlan, playSpeed);-->
        <!--}-->
        <!--var date = PlayArray[currentIndex];-->
        <!--var task = taskArray[cindex];-->
        <!--if (task.sdate > date) {-->
            <!--RealBimOcx.SetSubArrayClrInfo(task.eleids, 60, 255, 0xff447fed);-->
        <!--}-->
        <!--else {-->
            <!--if (task.edate < date) {-->
                <!--RealBimOcx.SetSubArrayClrInfo(task.eleids, 255, 255, 0);-->
            <!--}-->
            <!--else {-->
                <!--RealBimOcx.SetSubArrayClrInfo(task.eleids, 60, 255, 0xff00ff00);-->
            <!--}-->
        <!--}-->
    <!--}-->
    <!--//拖拽跳过任务-->
    <!--function skipTask(ds) {-->
        <!--var startDate = PlayArray[currentIndex];-->
        <!--//var date = new Date(ds).toLocaleString().replace(/:\d{1,2}$/, ' ');-->
        <!--var endDate = ds;//date.substring(0, 18).replace("年", "-").replace("月", "-").replace("日", "").replace(" ", "");-->
        <!--clearInterval(interval);-->
        <!--var endDateArray=endDate.split('-');-->
        <!--if (endDateArray.length > 2)-->
        <!--{-->
            <!--endDateNum = parseInt(endDateArray[0] + endDateArray[1] + endDateArray[2]);-->
            <!--if (startDate > endDateNum)-->
            <!--{-->
                <!--if ($("#hidElementStr").val() != null && $("#hidElementStr").val() != "") {-->
                    <!--RealBimOcx.SetSubArrayClrInfo($("#hidElementStr").val(), 60, 255, 0xff447fed);-->
                <!--}-->
                <!--RealBimOcx.SetSubArrayClrInfo($("#hidElmentIds").val(), 255, 255, 0);-->
                <!--SetSpecialColor();-->
            <!--}-->
        <!--}-->
        <!--if (endDateArray.length > 2) {-->
            <!--$.ajax({-->
                <!--type: "Get",-->
                <!--url: "/Schedule/ScheduleMonthTask/GetSkipDateElementIds?scheduleMonthId=" + $("#hidScheduleVersionID").val() + "&startDate=" + startDate + "&endDate=" + endDate + "&startNum=" + PlayArray[0] + "&endNum=" + PlayArray[PlayArray.length - 1] + "&_t=" + new Date(),-->
                <!--success: function (data) {-->
                    <!--if (data.result.elementStr != "") {-->
                        <!--var array = data.result.elementStr.split('-');-->
                        <!--if (array.length > 1) {-->
                            <!--RealBimOcx.SetSubArrayClrInfo(array[0], 60, 255, 0xff00ff00);-->
                            <!--RealBimOcx.SetSubArrayClrInfo(array[1], 255, 255, 0);-->
                        <!--}-->
                    <!--}-->
                    <!--if (data.result.otherElementStr != "")-->
                        <!--RealBimOcx.SetSubArrayClrInfo(data.result.otherElementStr, 60, 255, 0);-->
                    <!--if (data.result.currentIndex != 0)-->
                        <!--currentIndex = data.result.currentIndex;-->
                    <!--if ($("#spplay").attr("class") != "spplay") {-->
                        <!--interval = setInterval(playPlan, playSpeed);-->
                    <!--}-->
                    <!--//interval = setInterval(playPlan, playSpeed);-->
                    <!--//setTimeout(function () { interval = setInterval(playPlan, playSpeed); }, 1000);-->

                <!--}-->
            <!--});-->

        <!--}-->
    <!--}-->


<!--</script>-->


<!--<script language="javascript" for="RealBimOcx" event="WorkCompleteNotification(CompleteEvent,retError)">-->
    <!--RealBimOcx.SetAllSubClrInfos(255, 255, 0);-->
    <!--if (CompleteEvent == "LoadMainScene" && retError == 0) {-->
        <!--RealBimOcx.SetSceHugeObjVisible(true);-->
    <!--}-->
    <!--initTreeAndModelState();-->
<!--</script>-->
<!--<script language="javascript" for="RealBimOcx" event="OnRealBimOcxInited()">-->
    <!--var projectId = $(top.document).find("#projectId").val();-->
    <!--var serviceUrl = $(top.document).find("#serviceUrl").val();-->
    <!--if (!isNaN(projectId))-->
        <!--RealBimOcx.SwitchBIMScene(projectId);-->
    <!--else-->
        <!--RealBimOcx.SwitchBIMSceneSimple(serviceUrl, projectId);-->
    <!--RealBimOcx.SetSceVersionInfo(100, -1);-->
    <!--dataPath = RealBimOcx.GetOcxModuleDir() + "\\data";-->
<!--</script>-->
<!--<script language="javascript" for="RealBimOcx" event="OnCurSelModelChanged(strObjName, uObjSubID, fObjPosX, fObjPosY, fObjPosZ)">-->
    <!--RealBimOcx.BatchAddSubClrInfoBegin();-->
    <!--if (isMulti) {-->
        <!--multiSelModel.push(uObjSubID);-->
        <!--RealBimOcx.AddSubClrInfo(uObjSubID, 60, 255, 0);-->
    <!--}-->
    <!--else {-->
        <!--RealBimOcx.AddSubClrInfo(selModel, 0, 0, 0);-->
        <!--RealBimOcx.AddSubClrInfo(uObjSubID, 60, 255, 0);-->
        <!--selModel = uObjSubID;-->
    <!--}-->
    <!--RealBimOcx.BatchAddSubClrInfoEnd();-->

<!--</script>-->
<!--<script language="javascript" for="RealBimOcx" event="UIClicked(eType,uButtonMode)">-->
    <!--switch (eType) {-->
        <!--case "INITCAM": defaultViewPoint(); break;-->
    <!--}-->
<!--</script>-->
<!--<script type="text/javascript">-->
    <!--$(document).keyup(function (event) {-->
        <!--switch (event.keyCode) {-->
            <!--case 27:-->
                <!--RealBimOcx.SetHugeObjSubValidStateBegin();-->
                <!--RealBimOcx.SetHugeObjSubValidStateInfo(selModel, 1);-->
                <!--$.each(multiSelModel, function (i, item) {-->
                    <!--RealBimOcx.SetHugeObjSubValidStateInfo(item, 1);-->
                <!--});-->
                <!--RealBimOcx.SetHugeObjSubValidStateEnd();-->

                <!--RealBimOcx.BatchAddSubClrInfoBegin();-->
                <!--$.each(multiSelModel, function (i, item) {-->
                    <!--RealBimOcx.AddSubClrInfo(item, 0, 0, 0);-->
                <!--});-->
                <!--RealBimOcx.AddSubClrInfo(selModel, 0, 0, 0);-->
                <!--RealBimOcx.BatchAddSubClrInfoEnd();-->
                <!--selModel = 0;-->
                <!--multiSelModel = [];-->
                <!--break;-->
        <!--}-->
    <!--});-->
    <!--$(document).keydown(function (event) {-->
        <!--if (event.keyCode === 17) {-->
            <!--isMulti = true;-->
        <!--}-->
    <!--});-->
    <!--$(document).keyup(function (event) {-->
        <!--if (event.keyCode === 17)-->
            <!--isMulti = false;-->
    <!--});-->

    <!--window.onload = function () {-->
        <!--document.onmousewheel = function () {-->
            <!--if (event.ctrlKey)-->
                <!--return false;-->
        <!--}-->
    <!--};-->
<!--</script>-->
<!--</body>-->
<!--{include file="../../public/common_footer"}-->
</html>