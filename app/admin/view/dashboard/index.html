{include file="../app/public/common_header.html"}
<style>
    .layui-tab-title  li{
        padding: 0 20px;
    }
    #tableItem thead tr th{
        border-right: 1px solid #ddd;
        border-collapse: collapse;
    }
    #tableItem thead tr th:first-child{
        border-left: 1px solid #ddd;
    }
    #tableItem .even{
        background-color: #f9f9f9;
    }
    #tableItem .odd{
        background-color: #fff;
    }
</style>

<div class="layui-tab layui-tab-card" style="height: 100%;">
    <ul class="layui-tab-title">
        <li class="layui-this">待办任务</li>
        <li>已办任务</li>
    </ul>
    <div class="layui-tab-content" style="height: 100%;">
        <div class="layui-tab-item layui-show">
            <table id="tableItem" class="table table-striped table-bordered cell-border hover" cellspacing=0"  width="98%">
                <thead>
                    <tr>
                        <th>任务名称</th>
                        <th>接收日期</th>
                        <th>发送人</th>
                        <th>任务类别</th>
                        <th>操作</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td>123</td>
                        <td>123</td>
                        <td>123</td>
                        <td>123</td>
                        <td>123</td>
                    </tr>
                </tbody>
            </table>
            <div class="tbcontainer">
                <div class="mark"></div>
            </div>
        </div>
        <div class="layui-tab-item">

        </div>
    </div>
</div>
{include file="../app/public/common_footer.html"}
<script>
    layui.use(['element','layer'],function () {
      var elemnet = layui.element
        ,layer = layui.layer;
    })

    var tableItem = $('#tableItem').DataTable( {
      paging:false,
      processing: true,
      // serverSide: true,
      // scrollY: 600,
      // ajax: {
      //   "url":"{:url('admin/common/datatablesPre?tableName=admin_cate&id=')}"
      // },
      dom: 'rti',
      columnDefs: [
        {
          "orderable": false,
          "targets": [4],
          "render" :  function(data,type,row) {
            var html =  "<a type='button'   style='margin-left: 5px;color: blue;' onclick='handle("+data+")'>处理</a>" ;
            return html;
          }
        },
        {
          "orderable": false,
          "targets": [4]
        },
        {
          "targets": [1],
          "render" : function (data , type , row ) {
            var date = new Date(data*1000);
            var Y = date.getFullYear() + '-';
            var M = (date.getMonth()+1 < 10 ? '0'+(date.getMonth()+1) : date.getMonth()+1) + '-';
            var D = (date.getDate() < 10 ? '0' + (date.getDate()) : date.getDate()) + ' ';
            return Y + M + D;
          }
        }
      ],
      language: {
        "lengthMenu": "_MENU_",
        "zeroRecords": "没有找到记录",
        "info": "( 共 _TOTAL_ 项 )",
        "infoEmpty": "无记录",
        "infoFiltered": "(从 _MAX_ 条记录过滤)",
      },
      "fnInitComplete": function (oSettings, json) {
        $('#tableItem_info').insertBefore(".mark");
        $('.dataTables_wrapper,.tbcontainer').css("display","block");
      }
    });
    
    function handle() {
      layer.open({
        type:1,
        title:"处理",
        btn:["打回","编辑","审批","作废"],
        yes:function () {
          alert("打回")
        }
        ,btn2:function () {
          edit() ;
          return false;
        }
        ,btn3:function () {
          alert("审批");
          return false;
        }
        ,btn4:function () {
          alert("作废");
          return false;
        }
      })
    }

    function edit(){
      layer.open({
        type: 2,
        title: '在线填报',
        shadeClose: true,
        area: ['980px', '90%'],
        content: '/quality/Qualityform/edit?cpr_id=22&currentStep=0&isView=false'
      });
    }

</script>
</body>
</html>